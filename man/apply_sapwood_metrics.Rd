% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04e_sapwood_metrics.R
\name{apply_sapwood_metrics}
\alias{apply_sapwood_metrics}
\title{Apply sapwood metrics calculations to flux data}
\usage{
apply_sapwood_metrics(
  data,
  flux_col = "Q_cm3_hr",
  sapwood_area,
  normalise = FALSE,
  normalise_period = "global",
  Qps_max = NULL,
  leaf_area = NULL,
  leaf_area_units = "m2",
  datetime_col = "datetime"
)
}
\arguments{
\item{data}{Data frame containing sap flux results from calc_sap_flux() or
apply_sap_flux_integration(). Must contain a column with total flux values.}

\item{flux_col}{Character. Name of column containing total sap flux (Qp) in
cm³/hr. Default: "Q_cm3_hr".}

\item{sapwood_area}{Numeric. Total sapwood cross-sectional area (As) in cm².
Can be a single value (assumes constant across all rows) or a vector
matching the number of rows in data.}

\item{normalise}{Logical. Whether to calculate normalised flux density (Qpsn).
Default: FALSE.}

\item{normalise_period}{Character. Period for normalisation: "global",
"daily", "monthly", or "custom". Only used if normalise = TRUE.
Default: "global".}

\item{Qps_max}{Numeric. Custom maximum for normalisation. Only used if
normalise = TRUE and normalise_period = "custom". Default: NULL.}

\item{leaf_area}{Numeric. Total plant leaf area in m² (or cm²). If provided,
calculates leaf-area-specific flux (Qpl). Default: NULL (not calculated).}

\item{leaf_area_units}{Character. Units of leaf area: "m2" or "cm2".
Default: "m2".}

\item{datetime_col}{Character. Name of column containing datetime values.
Required if normalise_period is "daily" or "monthly". Default: "datetime".}
}
\value{
Input dataframe with additional columns:
\itemize{
\item Qps_cm3_hr_cm2: Sapwood-area-weighted mean flux density (always added)
\item Qps_cm_hr: Same as Qps_cm3_hr_cm2 but emphasises velocity units (always added)
\item Qpsn: Normalised flux density (added if normalise = TRUE)
\item Qpl_cm3_hr_m2 or Qpl_cm3_hr_cm2: Leaf-area-specific flux (added if leaf_area provided)
}
}
\description{
Convenience wrapper function that applies sapwood-area-weighted mean flux
density calculation (and optional normalisation and leaf-area metrics) to a
dataframe containing sap flux results. This adds new columns to the input
dataframe.
}
\details{
This function streamlines the calculation of derived metrics from total sap
flux, allowing easy comparison across trees and normalisation for temporal
analysis.

The function prints a diagnostic summary showing:
\itemize{
\item Sapwood area used
\item Range of Qps values
\item Normalisation details (if applicable)
\item Leaf area details (if applicable)
}
}
\examples{
\dontrun{
# Basic usage
results <- apply_sapwood_metrics(
  data = flux_results,
  sapwood_area = 245.5
)

# With normalisation
results <- apply_sapwood_metrics(
  data = flux_results,
  sapwood_area = 245.5,
  normalise = TRUE,
  normalise_period = "daily"
)

# With leaf area flux
results <- apply_sapwood_metrics(
  data = flux_results,
  sapwood_area = 245.5,
  leaf_area = 12.5,
  leaf_area_units = "m2"
)
}

}
\seealso{
Other sapwood metrics: 
\code{\link{calc_leaf_area_flux}()},
\code{\link{calc_mean_flux_density}()},
\code{\link{normalise_flux_density}()}
}
\concept{sapwood metrics}
