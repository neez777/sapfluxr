% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03d_spacing_correction_enhanced.R
\name{smooth_segment_junctions}
\alias{smooth_segment_junctions}
\title{Smooth Segment Junctions to Prevent Discontinuities}
\usage{
smooth_segment_junctions(
  vh_data,
  changepoints,
  method = "HRM",
  window_size = 3,
  verbose = TRUE
)
}
\arguments{
\item{vh_data}{Velocity data frame with spacing corrections already applied}

\item{changepoints}{Vector of changepoint dates defining segment boundaries}

\item{method}{Method to smooth (default: "HRM"). Only HRM should be smoothed
as only HRM had Burgess correction applied.}

\item{window_size}{Number of measurements on each side of junction to include
in moving average (default: 3). Total window = 2 * window_size + 1.}

\item{verbose}{Logical, whether to print progress (default: TRUE)}
}
\value{
The vh_data data frame with smoothed values at segment junctions
}
\description{
Applies a moving average across segment boundaries to smooth discontinuities
caused by baseline shifts. Only applied to HRM method (Burgess correction
is HRM-specific).
}
\details{
\strong{Why Smooth Junctions:}

When baseline offsets differ between segments (due to probe movement), the
Burgess correction can create artificial discontinuities at changepoints.
Real sap flow doesn't change instantaneously, so we apply a small moving
average window across junctions to blend the transition.

\strong{Window Size:}

Default of 3 means:
\itemize{
\item 3 measurements before changepoint
\item The changepoint measurement itself
\item 3 measurements after changepoint
\item Total window: 7 measurements
}

\strong{HRM Only:}

Only HRM is smoothed because:
\itemize{
\item Burgess correction only validated for HRM
\item Other methods (MHR, Tmax) have different correction factors
\item Phase 5 (method calibration) handles other methods
}

\strong{Applied to Both Sensors:}

Smoothing is applied independently to outer and inner sensors, each with
their own junction discontinuities.
}
\examples{
\dontrun{
# After spacing correction
vh_corrected <- apply_spacing_correction_both_sensors(vh_data, changepoints)

# Smooth junctions (default 3-point window)
vh_smoothed <- smooth_segment_junctions(
  vh_corrected$vh_corrected,
  changepoints,
  window_size = 3
)

# Larger window for more smoothing
vh_smoothed <- smooth_segment_junctions(
  vh_corrected$vh_corrected,
  changepoints,
  window_size = 5
)
}

}
\seealso{
Other spacing correction functions: 
\code{\link{apply_heartwood_reference_correction}()},
\code{\link{apply_manual_spacing_correction}()},
\code{\link{apply_spacing_correction}()},
\code{\link{apply_spacing_correction_both_sensors}()},
\code{\link{apply_spacing_correction_per_segment}()},
\code{\link{apply_spacing_correction_workflow}()},
\code{\link{calculate_burgess_coefficients}()},
\code{\link{calculate_zero_offset}()},
\code{\link{check_heartwood_reference_available}()},
\code{\link{get_correction_coefficients}()},
\code{\link{print_spacing_correction_summary}()}
}
\concept{spacing correction functions}
