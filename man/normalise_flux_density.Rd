% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04e_sapwood_metrics.R
\name{normalise_flux_density}
\alias{normalise_flux_density}
\title{Normalise sap flux density by maximum value}
\usage{
normalise_flux_density(Qps, period = "global", datetime = NULL, Qps_max = NULL)
}
\arguments{
\item{Qps}{Numeric vector. Sapwood-area-weighted mean sap flux density
(cm³/hr/cm²) from calc_mean_flux_density().}

\item{period}{Character. Period over which to calculate maximum:
\itemize{
\item "global": Maximum across entire dataset (default)
\item "daily": Maximum within each day (requires datetime parameter)
\item "monthly": Maximum within each month (requires datetime parameter)
\item "custom": Use provided Qps_max value
}}

\item{datetime}{POSIXct vector. Datetime stamps corresponding to Qps values.
Required if period is "daily" or "monthly". Optional otherwise.}

\item{Qps_max}{Numeric. Custom maximum value for normalisation. Only used
if period = "custom". If NULL and period = "custom", will use global max.}
}
\value{
Numeric vector of normalised sap flux density (Qpsn), dimensionless
values typically ranging from 0 to 1.
}
\description{
Normalises sapwood-area-weighted mean sap flux density (Qps) with respect to
the maximum value observed during a specified period. This produces a
dimensionless relative flux metric (Qpsn) ranging from 0 to 1.
}
\details{
The formula is:
Qpsn = Qps / Qps_max

Where:
\itemize{
\item Qps = sapwood-area-weighted mean flux density
\item Qps_max = maximum Qps during specified period
\item Qpsn = normalised flux density (0-1 range)
}

Normalisation is useful for:
\itemize{
\item Comparing temporal patterns across trees
\item Removing size-dependent variation
\item Emphasising relative changes in sap flux
}

Note: NA values in Qps are preserved in the output. The maximum is
calculated ignoring NA values.
}
\examples{
\dontrun{
# Global normalisation
Qpsn <- normalise_flux_density(Qps)

# Daily normalisation
Qpsn <- normalise_flux_density(
  Qps = flux_results$Qps,
  period = "daily",
  datetime = flux_results$datetime
)

# Custom maximum (e.g., from calibration period)
Qpsn <- normalise_flux_density(
  Qps = flux_results$Qps,
  period = "custom",
  Qps_max = 5.2
)
}

}
\seealso{
Other sapwood metrics: 
\code{\link{apply_sapwood_metrics}()},
\code{\link{calc_leaf_area_flux}()},
\code{\link{calc_mean_flux_density}()}
}
\concept{sapwood metrics}
