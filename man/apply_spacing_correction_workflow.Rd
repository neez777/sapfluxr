% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03a_spacing_correction.R
\name{apply_spacing_correction_workflow}
\alias{apply_spacing_correction_workflow}
\title{Apply Spacing Correction Workflow}
\usage{
apply_spacing_correction_workflow(
  vh_data,
  zero_periods,
  sensors = c("outer", "inner"),
  method = "HRM",
  method_col = "method",
  vh_col = "Vh_cm_hr",
  k_assumed = 0.0025,
  probe_spacing = 0.5,
  measurement_time = 80,
  lookup_table = NULL,
  create_new_col = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{vh_data}{Data frame containing validated/filtered velocity data}

\item{zero_periods}{List of zero-flow periods (see \code{\link{calculate_zero_offset}})}

\item{sensors}{Vector of sensor positions to process (default: c("outer", "inner"))}

\item{method}{Method to correct (default: "HRM")}

\item{method_col}{Name of method column (default: "method")}

\item{vh_col}{Name of velocity column (default: "Vh_cm_hr")}

\item{k_assumed}{Assumed thermal diffusivity (cmÂ²/s) (default: 0.0025)}

\item{probe_spacing}{Probe spacing (cm) (default: 0.5)}

\item{measurement_time}{Measurement time (sec) (default: 80)}

\item{lookup_table}{Optional pre-calculated Burgess lookup table. If NULL,
will calculate using \code{\link{calculate_burgess_coefficients}}}

\item{create_new_col}{Logical, whether to create new corrected column (default: TRUE)}

\item{verbose}{Logical, whether to print progress messages (default: TRUE)}
}
\value{
A list containing:
\item{vh_corrected}{Data frame with spacing corrections applied}
\item{zero_offset_results}{List of zero offset results per sensor}
\item{correction_coefficients}{List of correction coefficients per sensor}
\item{metadata}{List containing correction metadata}
}
\description{
Complete workflow for spacing correction using zero-flow calibration.
Orchestrates zero offset calculation, coefficient lookup, and correction application.
}
\details{
\strong{Workflow Steps:}

For each sensor position:
\enumerate{
\item Calculate zero offset from zero-flow periods
\item Look up Burgess correction coefficients
\item Apply linear correction to all data
\item Store metadata for reproducibility
}

\strong{Metadata Stored:}
\itemize{
\item Zero-flow period specifications
\item Zero offset values and quality metrics (CV)
\item Correction coefficients (a, b)
\item Thermal diffusivity assumed
\item Date/time of correction
}
}
\examples{
\dontrun{
# Complete spacing correction workflow
zero_periods <- list(
  list(start = "2024-05-01 00:00:00", end = "2024-05-05 23:59:59"),
  list(start = "2024-08-15 00:00:00", end = "2024-08-18 23:59:59")
)

correction_result <- apply_spacing_correction_workflow(
  vh_data = vh_cleaned,
  zero_periods = zero_periods,
  sensors = c("outer", "inner"),
  method = "HRM",
  k_assumed = 0.0025
)

# Extract corrected data
vh_corrected <- correction_result$vh_corrected

# View correction summary
print_spacing_correction_summary(correction_result)

# Check zero offset quality
print(correction_result$zero_offset_results$outer$overall_cv)
}

}
\references{
Burgess, S.S.O., Adams, M.A., Turner, N.C., Beverly, C.R., Ong, C.K.,
Khan, A.A.H., & Bleby, T.M. (2001). An improved heat pulse method to
measure low and reverse rates of sap flow in woody plants.
\emph{Tree Physiology}, 21(9), 589-598.
}
\seealso{
Other spacing correction functions: 
\code{\link{apply_manual_spacing_correction}()},
\code{\link{apply_spacing_correction}()},
\code{\link{apply_spacing_correction_per_segment}()},
\code{\link{calculate_burgess_coefficients}()},
\code{\link{calculate_zero_offset}()},
\code{\link{get_correction_coefficients}()},
\code{\link{print_spacing_correction_summary}()}
}
\concept{spacing correction functions}
