% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03b_burgess_correction.R
\name{validate_zero_offset}
\alias{validate_zero_offset}
\title{Apply Spacing Correction Workflow}
\usage{
validate_zero_offset(offset, probe_spacing = 0.5, measurement_time = 80)
}
\arguments{
\item{offset}{Detected zero-flow offset (cm/hr)}

\item{probe_spacing}{Nominal probe spacing (cm). Default: 0.5}

\item{measurement_time}{Measurement time (sec). Default: 80 (HRM window average)}

\item{vh_data}{Data frame containing validated/filtered velocity data}

\item{zero_periods}{List of zero-flow periods (see \code{\link{calculate_zero_offset}})}

\item{sensors}{Vector of sensor positions to process (default: c("outer", "inner"))}

\item{method}{Method to correct (default: "HRM")}

\item{method_col}{Name of method column (default: "method")}

\item{vh_col}{Name of velocity column (default: "Vh_cm_hr")}

\item{k_assumed}{Assumed thermal diffusivity (cm²/s) (default: 0.0025)}

\item{lookup_table}{Optional pre-calculated Burgess lookup table. If NULL,
will calculate using \code{\link{calculate_burgess_coefficients}}}

\item{create_new_col}{Logical, whether to create new corrected column (default: TRUE)}

\item{verbose}{Logical, whether to print progress messages (default: TRUE)}
}
\value{
A list containing:
\item{vh_corrected}{Data frame with spacing corrections applied}
\item{zero_offset_results}{List of zero offset results per sensor}
\item{correction_coefficients}{List of correction coefficients per sensor}
\item{metadata}{List containing correction metadata}

A list with:
\item{is_valid}{Logical, TRUE if offset is within valid range}
\item{offset}{The tested offset value}
\item{max_offset}{Maximum physically possible offset}
\item{probe_spacing}{Probe spacing used}
\item{measurement_time}{Measurement time used}
}
\description{
Complete workflow for spacing correction using zero-flow calibration.
Orchestrates zero offset calculation, coefficient lookup, and correction application.
}
\details{
\strong{Workflow Steps:}

For each sensor position:
\enumerate{
\item Calculate zero offset from zero-flow periods
\item Look up Burgess correction coefficients
\item Apply linear correction to all data
\item Store metadata for reproducibility
}

\strong{Metadata Stored:}
\itemize{
\item Zero-flow period specifications
\item Zero offset values and quality metrics (CV)
\item Correction coefficients (a, b)
\item Thermal diffusivity assumed
\item Date/time of correction
}

\strong{Physical Constraint:}

The Burgess correction solves for probe misalignment using:

\code{x_corrected = sqrt(x² - ln(ratio) * 4 * k * t)}

For this to be physically valid, the discriminant must be positive:

\code{x² - (offset * x * 4 * t) / 3600 > 0}

Solving for maximum offset:

\code{|offset_max| = (x * 3600) / (4 * t)}

\strong{Note:} Maximum offset is independent of thermal diffusivity (k).
It only depends on probe geometry and measurement timing.

\strong{Typical Values:}

For ICT SFM1x standard configuration (x = 0.5 cm, t = 80 sec):
\itemize{
\item Maximum offset: ±5.625 cm/hr
\item Validated range: ±5 cm/hr (Burgess et al. 2001)
}
}
\examples{
\dontrun{
# Complete spacing correction workflow
zero_periods <- list(
  list(start = "2024-05-01 00:00:00", end = "2024-05-05 23:59:59"),
  list(start = "2024-08-15 00:00:00", end = "2024-08-18 23:59:59")
)

correction_result <- apply_spacing_correction_workflow(
  vh_data = vh_cleaned,
  zero_periods = zero_periods,
  sensors = c("outer", "inner"),
  method = "HRM",
  k_assumed = 0.0025
)

# Extract corrected data
vh_corrected <- correction_result$vh_corrected

# View correction summary
print_spacing_correction_summary(correction_result)

# Check zero offset quality
print(correction_result$zero_offset_results$outer$overall_cv)
}
Validate Zero-Flow Offset for Burgess Correction

Validates that a detected zero-flow offset is within the physically possible
range for Burgess spacing correction. Offsets that are too large would require
temperature probes to be touching or overlapping the heater probe, which is
physically impossible.

}
\references{
Burgess, S.S.O., Adams, M.A., Turner, N.C., Beverly, C.R., Ong, C.K.,
Khan, A.A.H., & Bleby, T.M. (2001). An improved heat pulse method to
measure low and reverse rates of sap flow in woody plants.
\emph{Tree Physiology}, 21(9), 589-598.
}
\seealso{
Other spacing correction functions: 
\code{\link{apply_heartwood_reference_correction}()},
\code{\link{apply_manual_spacing_correction}()},
\code{\link{apply_spacing_correction}()},
\code{\link{apply_spacing_correction_both_sensors}()},
\code{\link{calculate_burgess_coefficients}()},
\code{\link{calculate_zero_offset}()},
\code{\link{get_correction_coefficients}()},
\code{\link{print_spacing_correction_summary}()},
\code{\link{smooth_segment_junctions}()}
}
\concept{spacing correction functions}
