% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04c_calibration_plots.R
\name{plot_sdma_transition}
\alias{plot_sdma_transition}
\title{Plot sDMA Transition Zone}
\usage{
plot_sdma_transition(
  data,
  threshold,
  window_days = 7,
  sensor_position = "outer",
  primary_method = "HRM",
  secondary_method,
  velocity_col = "Vh_cm_hr",
  mode = c("velocity", "peclet"),
  peclet_col = "hrm_peclet_number"
)
}
\arguments{
\item{data}{Data frame containing sDMA results with columns: datetime, method,
sensor_position, Vh_cm_hr (or velocity_col), Vh_sdma, sdma_source.}

\item{threshold}{Numeric. The velocity or Peclet threshold where switching occurs.}

\item{window_days}{Numeric. Number of days around the transition to display
(default: 7). The plot will show data from threshold Â± window_days.}

\item{sensor_position}{Character. Sensor position to plot ("outer" or "inner").
Default: "outer".}

\item{primary_method}{Character. Name of primary method (default: "HRM").}

\item{secondary_method}{Character. Name of secondary method (e.g., "MHR").}

\item{velocity_col}{Character. Name of velocity column (default: "Vh_cm_hr").}

\item{mode}{Character. Switching mode: "velocity" or "peclet" (default: "velocity").}

\item{peclet_col}{Character. Name of Peclet column if mode = "peclet"
(default: "hrm_peclet_number").}
}
\value{
A ggplot2 object showing:
\itemize{
\item Primary method values (fading out above threshold) - blue
\item Calibrated secondary values (fading in above threshold) - red
\item Combined sDMA velocity - green (should be continuous)
\item Vertical dashed line at threshold
\item Shaded region showing transition zone
}
}
\description{
Creates a diagnostic plot zooming in on the method transition zone to verify
smooth handover between primary and calibrated secondary methods. Visually
confirms there are no discontinuities ("steps") at the switching threshold.
}
\details{
\strong{Purpose:}

This diagnostic plot addresses the "attenuated data" problem where secondary
methods produce lower values than primary even in valid ranges. Without
proper handover calibration, this creates visible discontinuities ("steps")
at the switching threshold.

\strong{What to Look For:}

\itemize{
\item \strong{Good handover}: The green sDMA line should be continuous with no
visible jump at the threshold
\item \strong{Smooth transition}: Primary (blue) and calibrated secondary (red)
should converge at the threshold
\item \strong{No "volcano effect"}: Avoid sudden drops in velocity timeseries
}

\strong{Interpreting the Plot:}

\itemize{
\item Left of threshold: Blue line dominant (primary method used)
\item Right of threshold: Red line dominant (calibrated secondary used)
\item Green line (sDMA): Should show smooth transition through threshold
\item Any gap in green line = discontinuity problem (poor calibration)
}
}
\examples{
\dontrun{
# After applying sDMA with calibration
vh_sdma <- apply_sdma_switching(
  data = vh_corrected,
  secondary = "MHR",
  mode = "velocity",
  threshold = 10,
  calibrate = TRUE
)

# Check transition zone
plot_sdma_transition(
  data = vh_sdma,
  threshold = 10,
  window_days = 7,
  secondary_method = "MHR"
)
}

}
\seealso{
Other calibration plotting functions: 
\code{\link{plot_calibration_comparison}()}
}
\concept{calibration plotting functions}
