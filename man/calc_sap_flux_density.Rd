% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_flux_density.R
\name{calc_sap_flux_density}
\alias{calc_sap_flux_density}
\title{Calculate Sap Flux Density from Heat Pulse Velocity}
\usage{
calc_sap_flux_density(
  vh_results,
  wood_properties = NULL,
  thermal_diffusivity = 0.0025,
  add_metadata = TRUE
)
}
\arguments{
\item{vh_results}{Data frame with velocity results containing at minimum:
datetime, Vh_cm_hr columns}

\item{wood_properties}{List containing wood thermal properties. If NULL,
uses default values with a warning. Required elements:
\describe{
\item{fresh_density}{Fresh wood density (g/cm³)}
\item{dry_density}{Dry wood density (g/cm³)}
\item{moisture_content}{Gravimetric moisture content (decimal, 0-1)}
\item{specific_heat_capacity}{Specific heat capacity of dry wood (J/g/°C)}
}}

\item{thermal_diffusivity}{Thermal diffusivity of fresh sapwood (cm²/s).
Default: 0.0025 (typical for many species)}

\item{add_metadata}{Logical whether to add wood properties metadata to results
(default: TRUE)}
}
\value{
Data frame with original columns plus:
\describe{
\item{Jv_cm3_cm2_hr}{Sap flux density (cm³/cm²/hr)}
\item{correction_factor_Z}{Correction factor used in conversion}
\item{wood_properties}{List of wood properties used (if add_metadata = TRUE)}
}
}
\description{
Convert heat pulse velocity (Vh) to sap flux density (Jv) using wood
thermal properties and the correction factor approach of Burgess et al. (2001).
}
\details{
Uses the relationship from Burgess et al. (2001):
\deqn{J_v = V_s = Z \times V_h}

Where the correction factor Z is:
\deqn{Z = \frac{\rho_{dw}}{\rho_s} \times \frac{c_{dw} + mc \times c_s}{c_s}}

Where:
\itemize{
\item \eqn{\rho_{dw}} = dry wood density (g/cm³)
\item \eqn{\rho_s} = fresh sapwood density (g/cm³)
\item \eqn{c_{dw}} = specific heat capacity of dry wood (J/g/°C)
\item \eqn{mc} = moisture content (decimal)
\item \eqn{c_s} = specific heat capacity of water (4.18 J/g/°C)
}
}
\examples{
\dontrun{
# Define wood properties for eucalyptus
eucalyptus_props <- list(
  fresh_density = 0.8,
  dry_density = 0.55,
  moisture_content = 0.45,
  specific_heat_capacity = 1.5
)

# Convert velocities to flux density
flux_data <- calc_sap_flux_density(vh_results, eucalyptus_props)
}

}
\references{
Burgess, S.S.O., Adams, M.A., Turner, N.C., Beverly, C.R., Ong, C.K., Khan, A.A.H., Bleby, T.M. (2001).
An improved heat pulse method to measure low and reverse rates of sap flow in woody plants.
Tree Physiology, 21, 589-598.
}
\seealso{
\code{\link{calc_tree_sap_flux}}, \code{\link{aggregate_velocity_temporal}}
}
