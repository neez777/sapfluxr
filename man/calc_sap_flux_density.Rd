% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03h_flux_density.R
\name{calc_sap_flux_density}
\alias{calc_sap_flux_density}
\title{Convert Heat Pulse Velocity to Sap Flux Density}
\usage{
calc_sap_flux_density(Vh, wood_properties)
}
\arguments{
\item{Vh}{Heat pulse velocity (cm/h). Can be raw, spacing-corrected, or
wound-corrected velocity. Use the most corrected version available.}

\item{wood_properties}{WoodProperties R6 object with calculated Z factor
(sap_flux_conversion_factor). Must have run calculate_wood_properties() first.}
}
\value{
Sap flux density (cm³/cm²/h) = sap velocity (cm/h)
}
\description{
Converts corrected heat pulse velocity to sap flux density using the
wood-specific conversion factor (Z) from Burgess et al. (2001).
}
\details{
\strong{Formula:}

Jv = Z × Vh

where Z = (ρdw/ρs) × ((cdw + mc×cs) / cs)

This is the formula from Burgess et al. (2001), after Barrett et al. (1995).

\strong{Workflow Position:}

This conversion should be applied AFTER all velocity corrections:

\code{Vh (raw) → Spacing Correction → Recalc with updated k → Wound Correction → Jv}

**Physical Interpretation:**

Heat pulse velocity (Vh) measures the speed at which heat moves through
sapwood. This includes heat carried by both the moving sap AND the wood matrix.
The Z factor accounts for the heat capacity of the wood matrix to extract
the true sap velocity.
}
\examples{
\dontrun{
# After calculating wood properties
wood_props <- load_wood_properties("eucalyptus")
wood_props <- calculate_wood_properties(wood_props)

# Convert single velocity value
Vh <- 10.5  # cm/h
Jv <- calc_sap_flux_density(Vh, wood_props)

# Convert velocity data frame
vh_data$Jv <- calc_sap_flux_density(vh_data$Vc_cm_hr, wood_props)
}

}
\references{
Burgess, S.S.O., Adams, M.A., Turner, N.C., et al. (2001). Tree Physiology 21: 589-598.
Barrett, D.J., et al. (1995). Plant Cell Environ 18: 463-469.
}
\seealso{
Other flux density functions: 
\code{\link{apply_flux_conversion}()},
\code{\link{get_sap_flux_conversion_factor}()}
}
\concept{flux density functions}
