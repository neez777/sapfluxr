% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/01e_heat_pulse_velocity_core.R
\name{recalc_vh_with_k}
\alias{recalc_vh_with_k}
\title{Recalculate Heat Pulse Velocity with New Thermal Diffusivity}
\usage{
recalc_vh_with_k(vh_results, k_new, k_old = NULL, probe_spacing = NULL)
}
\arguments{
\item{vh_results}{A vh_results object from calc_heat_pulse_velocity() containing
the temp_ratio column}

\item{k_new}{New thermal diffusivity value (cm²/s)}

\item{k_old}{Original thermal diffusivity value used in initial calculation (cm²/s).
If NULL, attempts to extract from attributes.}

\item{probe_spacing}{Probe spacing (cm). If NULL, attempts to extract from attributes.}
}
\value{
A vh_results tibble with recalculated velocities and Peclet numbers
}
\description{
Efficiently recalculates velocities from existing results using a new thermal
diffusivity value, without needing to go back to raw temperature data. This is
particularly useful for Phase 3 corrections when estimated k differs from assumed k.
}
\details{
This function uses stored temperature ratios and times to recalculate velocities:

\strong{For ratio-based methods (HRM, MHR, HRMX):}
\code{Vh_new = (k_new / x) × ln(temp_ratio) × 3600}

\strong{For Tmax_Coh:}
\code{Vh_new = sqrt(x² - 4×k_new×t_max) / t_max × 3600}

**For Tmax_Klu:**
\code{Vh_new = (x/t_max - sqrt(k_new/t_max)) × 3600}

Peclet numbers are automatically recalculated for HRM results.
}
\examples{
\dontrun{
# Initial calculation with assumed k
vh_phase1 <- calc_heat_pulse_velocity(hpd, diffusivity = 0.0025)

# Phase 2: estimate actual k
k_result <- estimate_k_from_tmax(hpd, zero_periods, ...)

# Phase 3: efficiently recalculate with new k
vh_phase3 <- recalc_vh_with_k(
  vh_results = vh_phase1,
  k_new = k_result$k_mean,
  k_old = 0.0025,
  probe_spacing = 0.5
)
}

}
