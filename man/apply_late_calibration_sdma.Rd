% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04c_calibration_workflows.R
\name{apply_late_calibration_sdma}
\alias{apply_late_calibration_sdma}
\title{Apply Late Calibration and sDMA (After Corrections)}
\usage{
apply_late_calibration_sdma(
  vh_corrected,
  primary_method = "HRM",
  secondary_methods = c("MHR", "HRMXb"),
  sdma_methods = "MHR",
  sensor_position = "outer",
  manual_thresholds = NULL,
  peclet_threshold = 1
)
}
\arguments{
\item{vh_corrected}{Corrected velocity results (after spacing/wound corrections).
Must contain Vc_cm_hr column.}

\item{...}{All other parameters same as apply_early_calibration_sdma()}
}
\value{
List with same structure as apply_early_calibration_sdma(), but
timing = "late"
}
\description{
Applies method calibration and sDMA after spacing and wound corrections,
using corrected velocities. This is the recommended approach for most analyses.
}
\details{
The workflow is:
\enumerate{
\item User applies corrections to raw velocities (generates Vc_cm_hr)
\item Calibrate secondary methods to primary using CORRECTED velocities
\item Apply calibration transformations
\item Apply sDMA using CORRECTED velocities and Peclet numbers
}

\strong{Advantages of late calibration}:
\itemize{
\item Calibration on "clean" corrected velocities
\item sDMA based on corrected Peclet numbers (may be more accurate)
\item Method relationships clearer after corrections
}

\strong{Disadvantages}:
\itemize{
\item Can't see uncorrected method relationships
\item More workflow steps
}

\strong{Velocity column}: Uses Vc_cm_hr (corrected velocity) instead of Vh_cm_hr.
}
\examples{
\dontrun{
# Calculate velocities
vh <- calc_heat_pulse_velocity(hp_data, methods = c("HRM", "MHR", "HRMXb"), wood)

# Apply corrections FIRST
corrected <- apply_spacing_correction_both_sensors(vh, ...)
corrected <- apply_wound_correction(corrected$vh_corrected, ...)

# THEN calibrate on corrected data
late <- apply_late_calibration_sdma(
  corrected,
  secondary_methods = c("MHR", "HRMXb"),
  sdma_methods = "MHR"
)

# Methods: HRM, MHR, HRMXb (calibrated), sDMA:MHR (all using Vc_cm_hr)
unique(late$vh_with_sdma$method)
}

}
\seealso{
Other calibration workflows: 
\code{\link{apply_early_calibration_sdma}()},
\code{\link{compare_calibration_timing}()}
}
\concept{calibration workflows}
